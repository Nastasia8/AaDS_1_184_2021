def shift_up(index, heap): #создаем функцию понятия вверх
    while heap[index] > heap[(index-1)//2] and (index-1)//2 >= 0:
        heap[index], heap[(index-1)//2] = heap[(index-1)//2], heap[index]
        index = (index-1)//2 #индекс 
    return index+1

def shift_down(index, heap): #создаем функцию спуска вниз
    while 2*index+1 < len(heap): #пока индекс меньше длины
        left_index = 2*index+1 #левый индекс
        right_index = 2*index+2 #правый индекс
        child_index = left_index #потомки - левый индекс
        if right_index < len(heap) and heap[left_index] < heap[right_index]:#если правый индекс больше длины и куча левого индекса меньше кучи правого...
            child_index = right_index #потомки - правый индекс 
        if heap[child_index] <= heap[index]:
            break
        heap[index], heap[child_index] = heap[child_index], heap[index]
        index = child_index #присваивание 
    return index+1

def add(item, heap): #функция добавления 
    heap.append(item) #вызываем функцию
    return shift_up(len(heap)-1, heap)

def direct_extract(index, heap): #создаем функцию
    val = heap[len(heap)-1] #присваивание
    heap[index-1], heap[len(heap)-1] = heap[len(heap)-1], heap[index-1]
    ind = heap.pop() #индекс
    if val < ind: #если глубина меньше индекса...
        shift_down(index-1, heap) #вызов функции спуска вниз
    elif val > ind: #иначе...
        shift_up(index-1, heap)
    return ind #возвращаем индекс

def extract(heap): #cоздаем функцию извлечения
    heap[0], heap[len(heap)-1] = heap[len(heap)-1], heap[0]
    ind = heap.pop() #присваивание
    if heap: #если куча...
        return shift_down(0, heap), ind
    else: #иначе...
        return 0, ind

def get_max(heap): #создаем функцию get_max
    return heap[0] #возвращаем кучу

def main(): #основная часть
    heap = []
    result = []
    input_ = input().split() #ввод элемента
    n, m = int(input_[0]), int(input_[1]) #ввод
    for i in range(m): #пока i в указанном списке...
        data = input().split() #ввод
        if int(data[0]) == 1:
            if not heap: #если не куча...
                result.append(-1)
            else:
                result.append(extract(heap))
        elif int(data[0]) == 2:
            if len(heap) == n:
                result.append(-1)
            else:
                result.append(add(int(data[-1]), heap))
        elif int(data[0]) == 3:
            if len(heap) >= int(data[-1]) and int(data[-1]) > 0:
                result.append(direct_extract(int(data[-1]), heap))
            else:
                result.append(-1)

    for i in result: #пока i в результате 
        if type(i) == tuple:
            print(*i)
        else:
            print(i)
    print(*heap) #вывод

main() #вызов основной функции